{% extends "base.html" %}

{% block title %}Home - Feature Requestor{% endblock %}

{% block content %}
<div class="home-requester">
    <div class="home-logo" style="text-align: center; margin: 2rem 0;">
        {% if has_custom_icon and icon_url %}
            <img src="{{ icon_url }}" alt="Feature Requestor" style="max-width: 200px; max-height: 200px;">
        {% else %}
            <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Feature Requestor" style="max-width: 200px; max-height: 200px;" onerror="this.style.display='none';">
        {% endif %}
    </div>
    <h1>Welcome, {{ current_user.name }}!</h1>
    
    {% if stats.todo_items %}
    <section class="todo-items" style="margin: 2rem 0;">
        <h2>To-Do Items</h2>
        {% for item in stats.todo_items %}
        <div class="todo-item alert {% if item.type == 'error' %}alert-error{% elif item.type == 'warning' %}alert-warning{% else %}alert-info{% endif %}" style="margin-bottom: 1rem; padding: 1rem; border-radius: 8px; border-left: 4px solid {% if item.type == 'error' %}#ef4444{% elif item.type == 'warning' %}#f59e0b{% else %}#3b82f6{% endif %};">
            <h3 style="margin-top: 0; margin-bottom: 0.5rem;">{{ item.title }}</h3>
            <p style="margin-bottom: 0.75rem;">{{ item.message }}</p>
            <a href="{{ item.action_url }}" class="btn {% if item.type == 'error' %}btn-danger{% elif item.type == 'warning' %}btn-warning{% else %}btn-primary{% endif %}" style="text-decoration: none;">{{ item.action_text }}</a>
        </div>
        {% endfor %}
    </section>
    {% endif %}
    
    <div class="stats-summary">
        <h2>Summary</h2>
        <div class="stats-grid">
            <div class="stat-card">
                <h3>Total Requests</h3>
                <p class="stat-value">{{ stats.total_requests }}</p>
            </div>
            <div class="stat-card">
                <h3>Total Bid Amount</h3>
                <p class="stat-value">${{ stats.total_bid_amount }}</p>
            </div>
            <div class="stat-card">
                <h3>In Progress</h3>
                <p class="stat-value">{{ stats.in_progress_count }}</p>
                <p class="stat-sub">${{ stats.in_progress_bid }}</p>
            </div>
            <div class="stat-card">
                <h3>Finished</h3>
                <p class="stat-value">{{ stats.finished_count }}</p>
                <p class="stat-sub">${{ stats.finished_bid }}</p>
            </div>
            <div class="stat-card">
                <h3>Cancelled</h3>
                <p class="stat-value">{{ stats.cancelled_count }}</p>
                <p class="stat-sub">${{ stats.cancelled_bid }}</p>
            </div>
        </div>
    </div>
    
    {% if stats.approve_mode_requests %}
        <section class="approve-mode">
            <h2>Requests Awaiting Your Approval</h2>
            {% for request in stats.approve_mode_requests %}
                <div class="request-card">
                    <h3><a href="{{ url_for('feature_requests.detail', request_id=request.id) }}">{{ request.title }}</a></h3>
                    <p>Status: {{ request.status }}</p>
                    <a href="{{ url_for('feature_requests.detail', request_id=request.id) }}" class="btn btn-primary">Review</a>
                </div>
            {% endfor %}
        </section>
    {% endif %}
    
    <section class="my-requests">
        <h2>My Feature Requests</h2>
        {% for request in stats.user_requests %}
            <div class="request-card">
                <h3><a href="{{ url_for('feature_requests.detail', request_id=request.id) }}">{{ request.title }}</a></h3>
                <p>Status: {{ request.status }}</p>
            </div>
        {% else %}
            <p>You haven't created any feature requests yet.</p>
        {% endfor %}
    </section>
</div>
{% endblock %}

